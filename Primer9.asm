; masm dos exe #
.model small
.data
delta dd 0.001 ;???????? ?????????
divK dd 5.0 ;?????????? ????? ??????
xr dw 0 ;?????????? ????????? ?????
yr dw 0 
xrc dw 0
y1rc dw 0
y2rc dw 0
color db 10
save_ax dw ?
save_bx dw ?
save_cx dw ?
save_dx dw ?
i dw 0
.code
.486
start:  mov ax,@data
    mov ds,ax
    mov cx,0C470h ;???????? ?????????? ???????? ????? 
    mov ax,12h   ;????????????? ???????????? ?????? 
    int 10h
;------------------------------------------------------------------
    finit ;????????????? ???????????? 
    fldz
    mov ax,0C00h
    mov bh,0h
l1: fld st;alpha        ;??? ??? ??????
    fld st
    fsincos             ;?-?? x=round(alpha*DivK*cos(alpha))
    fmul divK
    fmul st,st(2)
    fistp word ptr xr ;??????? X ? ?????????? ??? ?????? ?? ????? 
    fmul divK
    fmul
    fistp word ptr yr ;??????? Y ? ?????????? ??? ?????? ?? ????? 
    push cx
    mov cx,xr
    add cx,320
    mov xrc,cx
    mov dx,yr
    add dx,240
    int 10h           ;??????? ????? ???????? ?????? 
    sub dx,yr
    mov y2rc,dx
    sub dx,yr
    mov y1rc,dx
    int 10h           ;??????? ????? ???????? ?????? 
    inc al
    pop cx
    fadd delta;????????? ????? ???????? alpha
    mov save_ax,ax
    mov ax,y1rc
    cmp ax,y2rc
    mov ax,save_ax
    jne propustit
    mov save_ax,ax
    mov save_bx,bx
    mov save_cx,cx
    mov save_dx,dx
    fldz
    mov cx,3141
    mov al,color
l2: fld st;alpha        ;??? ??? ??????
    fcos             ;?-?? x=round(DivK*cos(alpha))
    fmul divK
    fistp word ptr xr ;??????? X ? ?????????? ??? ?????? ?? ?????
    fld st
    fsin 
    fmul divK
    fistp word ptr yr ;??????? Y ? ?????????? ??? ?????? ?? ????? 
    push cx
    mov cx,xr
    add cx,xrc
    mov dx,yr
    add dx,y2rc
    int 10h           ;??????? ????? ???????? ?????? 
    sub dx,yr
    sub dx,yr
    int 10h           ;??????? ????? ???????? ?????? 
    pop cx
    fadd delta;????????? ????? ???????? alpha
    loop l2
    mov ax,save_ax
    mov bx,save_bx
    mov cx,save_cx
    mov dx,save_dx
    fistp word ptr xr
    propustit:
    sub cx,1
    cmp cx,0
    jne l1 ;???? ?? cx
    
;--------------------------------------------------------------------
    mov ah,0 ;???????? ??????? ??????? 
    int 16h
    mov ax,3 ;??????? ??????? ? TextMode
    int 10h
exit:   mov ah,4Ch ;??????????? ?????
    int 21h
end start